<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Anesthesia Monitoring Record | 麻醉記錄系統</title>
    <link rel="stylesheet" href="./theme-technical.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
</head>

<body>
    <div id="app">
        <header class="main-header glass">
            <div class="header-left">
                <h1>麻醉監控記錄表</h1>
            </div>

            <div class="timer-container">
                <div class="anesthesia-timer">
                    <span class="timer-label">Current Time:</span>
                    <span id="current-time-display" class="timer-value">--:--:--</span>
                    <div class="timer-controls" style="visibility: hidden;">
                        <!-- Spacer to align widths -->
                    </div>
                </div>
                <div class="anesthesia-timer">
                    <span class="timer-label">Anesthesia Time:</span>
                    <span id="timer-display" class="timer-value">00:00:00</span>
                    <div class="timer-controls">
                        <button id="btn-start-case" class="btn-primary btn-sm">Start</button>
                        <button id="btn-end-case" class="btn-danger btn-sm" disabled>End</button>
                    </div>
                </div>
            </div>

            <div class="header-right">
                <div class="actions">
                    <button id="export-json" class="btn-secondary">Export JSON</button>
                    <button id="export-pdf" class="btn-secondary">Export PDF</button>
                    <button id="clear-data" class="btn-danger">Clear All</button>
                </div>
            </div>
        </header>

        <main class="dashboard">
            <!-- Tabs Navigation -->
            <div class="tabs-nav-container">
                <div class="tabs-nav">
                    <button class="tab-btn" data-tab="tab-patient">Patient Info</button>
                    <button class="tab-btn" data-tab="tab-setup">Setup</button>
                    <button class="tab-btn" data-tab="tab-drug">Drugs</button>
                    <button class="tab-btn" data-tab="tab-epidural">Epidural</button>
                    <button class="tab-btn" data-tab="tab-fluid">Fluids</button>
                </div>
            </div>

            <!-- Tab Content Wrapper -->
            <div class="tab-content-wrapper">

                <!-- Tab 1: Patient Info -->
                <div id="tab-patient" class="tab-content">
                    <div class="card glass case-info">
                        <div class="card-header section-header">
                            <h2>個案資訊 Patient Info</h2>
                        </div>
                        <div class="card-content grid-form">
                            <div class="form-group">
                                <label>Pet Name (寵物名字)</label>
                                <input type="text" id="pet-name" placeholder="Enter Pet Name">
                            </div>
                            <div class="form-group">
                                <label>Medical Record # (病歷編號)</label>
                                <input type="text" id="animal-id" placeholder="Enter MRN">
                            </div>
                            <div class="form-group">
                                <label>Species / Breed</label>
                                <input type="text" id="breed" placeholder="Species / Breed">
                            </div>
                            <div class="form-group">
                                <label>Date</label>
                                <input type="date" id="date">
                            </div>
                            <div class="form-group">
                                <label>Weight (kg)</label>
                                <input type="number" step="0.1" id="weight" inputmode="decimal" placeholder="0.0">
                            </div>
                            <div class="form-group">
                                <label>Age (年齡)</label>
                                <div class="age-inputs">
                                    <select id="age-y">
                                        <!-- 0-25 -->
                                    </select> Y
                                    <select id="age-m">
                                        <!-- 0-12 -->
                                    </select> M
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Sex</label>
                                <select id="sex">
                                    <option value="M">Male</option>
                                    <option value="F">Female</option>
                                    <option value="MN">MN</option>
                                    <option value="FS">FS</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Anesthetist</label>
                                <input type="text" id="anesthetist">
                            </div>
                            <div class="form-group">
                                <label>Surgeon</label>
                                <input type="text" id="surgeon">
                            </div>
                            <div class="form-group span-full">
                                <label>Procedure (手術項目)</label>
                                <input type="text" id="procedure" placeholder="Enter Procedure">
                            </div>
                        </div>
                    </div>
                </div> <!-- End Tab 1 -->

                <!-- Tab 2: Setup -->
                <div id="tab-setup" class="tab-content">
                    <div class="card glass setup-section">
                        <div class="card-header section-header">
                            <h2>設備設定 Setup</h2>
                        </div>
                        <div class="card-content grid-form">
                            <div class="checkbox-group">
                                <label><input type="checkbox" id="setup-ventilator"> Ventilator</label>
                                <label><input type="checkbox" id="setup-mask"> Mask</label>
                            </div>
                            <div class="setup-details grid-form" style="margin-top: 1.5rem;">
                                <div class="form-group">
                                    <label>ET Tube Size</label>
                                    <select id="et-tube-size">
                                        <!-- 2.5 - 15 -->
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Intubation Time</label>
                                    <input type="time" id="intubation-time">
                                </div>
                                <div class="form-group">
                                    <label>Extubation Time</label>
                                    <input type="time" id="extubation-time">
                                </div>
                                <div class="form-group">
                                    <label>IVC Site</label>
                                    <select id="ivc-site"></select>
                                </div>
                                <div class="form-group">
                                    <label>BP Cuff Size</label>
                                    <input type="text" id="bp-cuff-size">
                                </div>
                            </div>
                        </div>
                    </div>
                </div> <!-- End Tab 2 -->

                <!-- Tab 3: Drug Management -->
                <div id="tab-drug" class="tab-content">
                    <div class="card glass drug-section">
                        <div class="card-header section-header">
                            <h2>藥物與常用量 Drug Management</h2>
                            <button id="add-drug" class="btn-icon">+</button>
                        </div>
                        <div class="card-content table-container">
                            <table id="drug-table">
                                <thead>
                                    <tr>
                                        <th>Drug</th>
                                        <th>Dose</th>
                                        <th>Unit</th>
                                        <th>Total</th>
                                        <th>Route</th>
                                        <th>Time</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Rows added dynamically -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div> <!-- End Tab 3 -->

                <!-- Tab 4: Epidural -->
                <div id="tab-epidural" class="tab-content">
                    <div class="card glass epidural-section">
                        <div class="card-header section-header">
                            <h2>局部麻醉 Epidural / Block</h2>
                            <button id="add-epidural" class="btn-icon">+</button>
                        </div>
                        <div class="card-content table-container">
                            <table id="epidural-table">
                                <thead>
                                    <tr>
                                        <th>Drug</th>
                                        <th>Dose</th>
                                        <th>Unit</th>
                                        <th>Total</th>
                                        <th>Route</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Rows added dynamically -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div> <!-- End Tab 4 -->

                <!-- Tab 5: Fluids -->
                <div id="tab-fluid" class="tab-content">
                    <div class="card glass fluid-grid">
                        <div class="card-header section-header">
                            <h2>輸液與 CRI 記錄 Fluids & CRIs</h2>
                            <button id="add-fluid" class="btn-icon">+</button>
                        </div>
                        <div class="card-content table-container">
                            <table id="fluid-table">
                                <thead>
                                    <tr>
                                        <th>Item</th>
                                        <th>Rate (ml/hr)</th>
                                        <th colspan="2">Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Rows added dynamically -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div> <!-- End Tab 5 -->

            </div> <!-- End Tab Content Wrapper -->

            <!-- Persistent Bottom Sections -->
            <div class="persistent-sections">
                <details class="card glass monitoring-chart" open>
                    <div class="card-header section-header">
                        <h2>生命徵象監控 Monitoring Record</h2>
                    </div>
                    <div class="card-content">
                        <!-- Dashboard Grid: Chart Left + Vital Cards Right -->
                        <div class="monitoring-dashboard">
                            <div class="chart-panel">
                                <div class="chart-wrapper">
                                    <div class="chart-scroll-container">
                                        <canvas id="vitalChart"></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="vital-cards-panel">
                                <div class="vital-cards-grid">
                                    <div class="vital-card">
                                        <label>SYS</label>
                                        <span class="vital-display" id="display-sys">--</span>
                                        <input type="number" id="input-sys" inputmode="numeric" placeholder="mmHg">
                                    </div>
                                    <div class="vital-card">
                                        <label>DIA</label>
                                        <span class="vital-display" id="display-dia">--</span>
                                        <input type="number" id="input-dia" inputmode="numeric" placeholder="mmHg">
                                    </div>
                                    <div class="vital-card">
                                        <label>PULSE</label>
                                        <span class="vital-display" id="display-pulse">--</span>
                                        <input type="number" id="input-pulse" inputmode="numeric" placeholder="bpm">
                                    </div>
                                    <div class="vital-card">
                                        <label>SpO2</label>
                                        <span class="vital-display" id="display-spo2">--</span>
                                        <input type="number" id="input-spo2" inputmode="numeric" placeholder="%">
                                    </div>
                                    <div class="vital-card">
                                        <label>ETCO2</label>
                                        <span class="vital-display" id="display-etco2">--</span>
                                        <input type="number" id="input-etco2" inputmode="numeric" placeholder="mmHg">
                                    </div>
                                    <div class="vital-card">
                                        <label>BT</label>
                                        <span class="vital-display" id="display-bt">--</span>
                                        <input type="number" id="input-bt" inputmode="decimal" step="0.1"
                                            placeholder="°C">
                                    </div>
                                    <div class="vital-card">
                                        <label>RR</label>
                                        <span class="vital-display" id="display-rr">--</span>
                                        <input type="number" id="input-rr" inputmode="numeric" placeholder="rpm">
                                    </div>
                                    <div class="vital-card">
                                        <label>ISO %</label>
                                        <span class="vital-display" id="display-iso">--</span>
                                        <input type="number" id="input-iso" inputmode="decimal" step="0.1"
                                            placeholder="%">
                                    </div>
                                </div>
                                <button id="log-vitals" class="btn-primary btn-log">LOG</button>
                            </div>
                        </div>
                        <!-- History Table (full width) -->
                        <div class="table-container history-table">
                            <table id="vitals-history">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>SYS</th>
                                        <th>DIA</th>
                                        <th>MEAN</th>
                                        <th>PULSE</th>
                                        <th>SpO2</th>
                                        <th>ETCO2</th>
                                        <th>BT</th>
                                        <th>RR</th>
                                        <th>ISO %</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </details>

                <!-- Section 6: Additional Info -->
                <details class="card glass additional-info" open>
                    <div class="card-header section-header">
                        <h2>手 術 筆 記 Procedure Note</h2>
                    </div>
                    <div class="card-content sidebar-details">
                        <div class="card-section" style="grid-column: span 12;">
                            <textarea id="procedure-note" rows="5"
                                placeholder="Enter procedure notes and complications..."></textarea>
                        </div>
                    </div>
                </details>
                </details>
            </div> <!-- End Persistent Sections -->
        </main>

        <footer class="app-footer">
            <div class="actions">
                <!-- Buttons removed as requested -->
            </div>
        </footer>
    </div>

    <!-- Confirm Modal -->
    <dialog id="confirm-modal" class="modal">
        <div class="modal-content">
            <h3>Clear All Data?</h3>
            <p>This action cannot be undone. All recorded data will be permanently deleted.</p>
            <div class="modal-actions">
                <button id="cancel-clear" class="btn-secondary">Cancel</button>
                <button id="confirm-clear" class="btn-danger">Delete</button>
            </div>
        </div>
    </dialog>

    <script type="module" src="./main.js"></script>
</body>

</html>